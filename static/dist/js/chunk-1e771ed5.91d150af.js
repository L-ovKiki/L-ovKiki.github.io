(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e771ed5"],{"30a5":function(e,t,n){},"497a":function(e,t,n){"use strict";var r=n("62a2"),a=n.n(r);a.a},"4d63":function(e,t,n){var r=n("83ab"),a=n("da84"),s=n("94ca"),c=n("7156"),i=n("9bf2").f,o=n("241c").f,u=n("44e7"),h=n("ad6d"),l=n("9f7f"),f=n("6eeb"),d=n("d039"),p=n("69f3").set,g=n("2626"),m=n("b622"),v=m("match"),x=a.RegExp,S=x.prototype,w=/a/g,b=/a/g,_=new x(w)!==w,T=l.UNSUPPORTED_Y,k=r&&s("RegExp",!_||T||d((function(){return b[v]=!1,x(w)!=w||x(b)==b||"/a/i"!=x(w,"i")})));if(k){var O=function(e,t){var n,r=this instanceof O,a=u(e),s=void 0===t;if(!r&&a&&e.constructor===O&&s)return e;_?a&&!s&&(e=e.source):e instanceof O&&(s&&(t=h.call(e)),e=e.source),T&&(n=!!t&&t.indexOf("y")>-1,n&&(t=t.replace(/y/g,"")));var i=c(_?new x(e,t):x(e,t),r?this:S,O);return T&&n&&p(i,{sticky:n}),i},R=function(e){e in O||i(O,e,{configurable:!0,get:function(){return x[e]},set:function(t){x[e]=t}})},y=o(x),H=0;while(y.length>H)R(y[H++]);S.constructor=O,O.prototype=S,f(a,"RegExp",O)}g("RegExp")},"62a2":function(e,t,n){},efe3:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search-container"},[n("form",{staticClass:"search-form",attrs:{action:"/"}},[n("van-search",{attrs:{"show-action":"",placeholder:"请输入搜索关键词",background:"#3296FA"},on:{search:e.onSearch,cancel:e.onCancel,focus:function(t){e.isResultShow=!1}},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}})],1),e.isResultShow?n("search-result",{attrs:{"search-text":e.searchText}}):e.searchText?n("search-suggestion",{attrs:{"search-text":e.searchText},on:{search:e.onSearch}}):n("search-history",{attrs:{"search-histories":e.searchHistories},on:{"clear-search-histories":function(t){e.searchHistories=[]},search:e.onSearch}})],1)},a=[],s=(n("c975"),n("a434"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search-history"},[n("van-cell",{attrs:{title:"搜索历史"}},[e.isDeleteShow?n("div",[n("span",{on:{click:function(t){return e.$emit("clear-search-histories")}}},[e._v("全部删除")]),e._v(" "),n("span",{on:{click:function(t){e.isDeleteShow=!1}}},[e._v("完成")])]):n("van-icon",{attrs:{name:"delete"},on:{click:function(t){e.isDeleteShow=!0}}})],1),e._l(e.searchHistories,(function(t,r){return n("van-cell",{key:r,attrs:{title:t},on:{click:function(n){return e.onSearchItemClick(t,r)}}},[n("van-icon",{directives:[{name:"show",rawName:"v-show",value:e.isDeleteShow,expression:"isDeleteShow"}],attrs:{name:"close"}})],1)}))],2)}),c=[],i={name:"SearchHistory",components:{},props:{searchHistories:{type:Array,required:!0}},data:function(){return{isDeleteShow:!1}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{onSearchItemClick:function(e,t){this.isDeleteShow?this.searchHistories.splice(t,1):this.$emit("search",e)}}},o=i,u=n("2877"),h=Object(u["a"])(o,s,c,!1,null,"24acdda0",null),l=h.exports,f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search-suggestion"},e._l(e.suggestions,(function(t,r){return n("van-cell",{key:r,attrs:{title:t,icon:"search"},on:{click:function(n){return e.$emit("search",t)}}},[n("div",{attrs:{slot:"title"},domProps:{innerHTML:e._s(e.highlight(t))},slot:"title"})])})),1)},d=[],p=(n("4d63"),n("ac1f"),n("25f0"),n("5319"),n("96cf"),n("1da1")),g=n("b775"),m=function(e){return Object(g["a"])({method:"GET",url:"/app/v1_0/suggestion",params:{q:e}})},v=function(e){return Object(g["a"])({method:"GET",url:"/app/v1_0/search",params:e})},x=n("2ef0"),S={name:"SearchSuggestion",components:{},props:{searchText:{type:String,required:!0}},data:function(){return{suggestions:[]}},computed:{},watch:{searchText:{handler:Object(x["debounce"])((function(e){this.loadSearchSuggestions(e)}),200),immediate:!0}},created:function(){},mounted:function(){},methods:{loadSearchSuggestions:function(e){var t=this;return Object(p["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,m(e);case 3:r=n.sent,a=r.data,t.suggestions=a.data.options,n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](0),t.$toast("数据获取失败，请稍后重试");case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))()},highlight:function(e){var t=new RegExp(this.searchText,"gi");return e.replace(t,'<span class="active">'.concat(this.searchText,"</span>"))}}},w=S,b=(n("497a"),Object(u["a"])(w,f,d,!1,null,"47cfe78b",null)),_=b.exports,T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search-result"},[n("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了",error:e.error,"error-text":"加载失败，请点击重试"},on:{"update:error":function(t){e.error=t},load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.list,(function(e,t){return n("van-cell",{key:t,attrs:{title:e.title}})})),1)],1)},k=[],O=n("2909"),R={name:"SearchResult",components:{},props:{searchText:{type:String,required:!0}},data:function(){return{list:[],loading:!1,finished:!1,page:1,per_page:20,error:!1}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{onLoad:function(){var e=this;return Object(p["a"])(regeneratorRuntime.mark((function t(){var n,r,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,v({page:e.page,per_page:e.per_page,q:e.searchText});case 3:r=t.sent,a=r.data,s=a.data.results,(n=e.list).push.apply(n,Object(O["a"])(s)),e.loading=!1,s.length?e.page++:e.finished=!0,t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](0),e.error=!0,e.loading=!1;case 15:case"end":return t.stop()}}),t,null,[[0,11]])})))()}}},y=R,H=Object(u["a"])(y,T,k,!1,null,"45a4e675",null),E=H.exports,j=n("5d2d"),C={name:"searchIndex",components:{SearchHistory:l,SearchSuggestion:_,SearchResult:E},props:{},data:function(){return{searchText:"",isResultShow:!1,searchHistories:Object(j["a"])("TOUTIAO_SEARCH_HISTORIES")||[]}},computed:{},watch:{searchHistories:function(e){Object(j["b"])("TOUTIAO_SEARCH_HISTORIES",e)}},created:function(){},mounted:function(){},methods:{onSearch:function(e){this.searchText=e;var t=this.searchHistories.indexOf(e);-1!==t&&this.searchHistories.splice(t,1),this.searchHistories.unshift(e),this.isResultShow=!0},onCancel:function(){this.$router.back()}}},I=C,$=(n("ff63"),Object(u["a"])(I,r,a,!1,null,"de2e9f44",null));t["default"]=$.exports},ff63:function(e,t,n){"use strict";var r=n("30a5"),a=n.n(r);a.a}}]);
//# sourceMappingURL=chunk-1e771ed5.91d150af.js.map